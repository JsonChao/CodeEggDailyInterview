#### 有了二叉查找树、平衡树为什么还需要红黑树

##### 参考答案

1. 二叉查找树的缺点
   二叉查找树的特点就是左子树的节点值比父亲节点小，而右子树的节点值比父亲节点大，如图
   [![img](https://camo.githubusercontent.com/dea0127b58f588d15884fffd589a3280aef11946/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d5069635233304547344372446658473231646845486639535070634263594b50524d42326962735647354c696273347835696169616d47304747323256725970364e5866512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)](https://camo.githubusercontent.com/dea0127b58f588d15884fffd589a3280aef11946/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d5069635233304547344372446658473231646845486639535070634263594b50524d42326962735647354c696273347835696169616d47304747323256725970364e5866512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)

   

   基于二叉查找树的这种特点，我们在查找某个节点的时候，可以采取类似于二分查找的思想，快速找到某个节点。n 个节点的二叉查找树，正常的情况下，查找的时间复杂度为 O（logn）。
   之所以说是正常情况下，是因为二叉查找树有可能出现一种极端的情况，例如
   [![img](https://camo.githubusercontent.com/41951c9b5235b3aebc0919a4d0ac2506223295dc/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437270534d6c4c4f6d6149564544636d50664f544a765271546f6a544372306b356963686153457a6273486e55476b4c716e77744f745965512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)](https://camo.githubusercontent.com/41951c9b5235b3aebc0919a4d0ac2506223295dc/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437270534d6c4c4f6d6149564544636d50664f544a765271546f6a544372306b356963686153457a6273486e55476b4c716e77744f745965512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)
   这种情况也是满足二叉查找树的条件，然而，此时的二叉查找树已经近似退化为一条链表，这样的二叉查找树的查找时间复杂度顿时变成了 O(n)，可想而知，我们必须不能让这种情况发生，为了解决这个问题，于是我们引申出了平衡二叉树。

   

2. 平衡二叉树
   平衡二叉树就是为了解决二叉查找树退化成一颗链表而诞生了，平衡树具有如下特点：

   - 具有二叉查找树的全部特性。
   - 每个节点的左子树和右子树的高度差至多等于1。

例如：图一就是一颗平衡树了，而图二则不是(节点右边标的是这个节点的高度)
[![图一](https://camo.githubusercontent.com/a96d4c9a596ed52f7b111b1ce76ef8c4b38fb375/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d5069635233304547344372585441567269617130454355734761686e6f615a485965376737417374794c38634e7a4e31557348725872696331627769634e3155493177772f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)](https://camo.githubusercontent.com/a96d4c9a596ed52f7b111b1ce76ef8c4b38fb375/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d5069635233304547344372585441567269617130454355734761686e6f615a485965376737417374794c38634e7a4e31557348725872696331627769634e3155493177772f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)
[![图二](https://camo.githubusercontent.com/8cc8c82cce0880c24a409ebf28ddbddca3f1787c/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437268387a504974736f53744f7167486c4d4e574e63594669616461397a4c6b50384853445956434563593346586963784d7557676e676b72512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)](https://camo.githubusercontent.com/8cc8c82cce0880c24a409ebf28ddbddca3f1787c/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437268387a504974736f53744f7167486c4d4e574e63594669616461397a4c6b50384853445956434563593346586963784d7557676e676b72512f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)

对于图二，因为节点9的左孩子高度为2，而右孩子高度为0。他们之间的差值超过1了。平衡树基于这种特点就可以保证不会出现大量节点偏向于一边的情况了。关于平衡树如何构建、插入、删除、左旋、右旋等操作这里不在说明.于是，通过平衡树，我们解决了二叉查找树的缺点。对于有 n 个节点的平衡树，最坏的查找时间复杂度也为 O(logn)。

为什么有了平衡树还需要红黑树？
虽然平衡树解决了二叉查找树退化为近似链表的缺点，能够把查找时间控制在 O(logn)，不过却不是最佳的，因为平衡树要求每个节点的左子树和右子树的高度差至多等于1，这个要求实在是太严了，导致每次进行插入/删除节点的时候，几乎都会破坏平衡树的第二个规则，进而我们都需要通过左旋和右旋来进行调整，使之再次成为一颗符合要求的平衡树。

显然，如果在那种插入、删除很频繁的场景中，平衡树需要频繁着进行调整，这会使平衡树的性能大打折扣，为了解决这个问题，于是有了红黑树，红黑树具有如下特点：

```
1. 具有二叉查找树的特点。
2. 根节点是黑色的；
3. 每个叶子节点都是黑色的空节点（NIL），也就是说，叶子节点不存数据。
4. 任何相邻的节点都不能同时为红色，也就是说，红色节点是被黑色节点隔开的。
5. 每个节点，从该节点到达其可达的叶子节点是所有路径，都包含相同数目的黑色节点。
```

例如下面的图片（注意，图片中黑色的、空的叶子节点没有画出）（图片来自极客时间）
[![img](https://camo.githubusercontent.com/8dce7e314529a7e79e18fc715028a4322bec6b68/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437255696174434739446b596d696332306c684670594b6f366a43656f424f4e7a43767546626a723637354a4c633757593033336168373154772f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)](https://camo.githubusercontent.com/8dce7e314529a7e79e18fc715028a4322bec6b68/68747470733a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f6239355148506b634f4d4252336c5a676963623746764d506963523330454734437255696174434739446b596d696332306c684670594b6f366a43656f424f4e7a43767546626a723637354a4c633757593033336168373154772f3634303f77785f666d743d706e672674703d7765627026777866726f6d3d352677785f6c617a793d312677785f636f3d31)
正是由于红黑树的这种特点，使得它能够在最坏情况下，也能在 O(logn) 的时间复杂度查找到某个节点。

与平衡树不同的是，红黑树在插入、删除等操作，不会像平衡树那样，频繁着破坏红黑树的规则，所以不需要频繁着调整，这也是我们为什么大多数情况下使用红黑树的原因。不过，如果你要说，单单在查找方面的效率的话，平衡树比红黑树快。所以，我们也可以说，红黑树是一种不大严格的平衡树。也可以说是一个折中发方案。

总结：平衡树是为了解决二叉查找树退化为链表的情况，而红黑树是为了解决平衡树在插入、删除等操作需要频繁调整的情况。

参考来自[Hollis](https://mp.weixin.qq.com/s?__biz=MzI3NzE0NjcwMg==&mid=2650124373&idx=2&sn=daaeb4c3f6128224aad199de2071c2f2&chksm=f36bad74c41c24620442e8e054b14358689da083f270adff9c2ee02ba8bf96748f4f7f5c44c3&mpshare=1&scene=1&srcid=&key=0c05566442c631fc2b30d1763ae6e3ced36cfff611be01961c730019faf5c6633830ce66d0bd566c331a7d84847e36dd60cb94663a2b55a62cfc06425d26635d74d4fabf5c54f6e7c8899f37f43a8196&ascene=1&uin=ODI1ODQxNjYy&devicetype=Windows+10&version=62060833&lang=zh_CN&pass_ticket=2RdjOkuXN8ydIKrZzb9VMgyhuEwkQckv%2FZjGkzcltdnaaHeHZ6xt05ix7WrTDiQ5)



##### 蛋友补充

###### From [RainFool](https://github.com/RainFool) 

二叉查找树是最常用的一种二叉树，它支持快速插入、删除、查找操作，各个操作时间复杂度和树高度成正比logn，但是极端情况会退化成链表。
平衡二叉树就是为了防止退化设计出的数据结构，平衡二叉树中平衡的意思，就是让左右两个子树看起来比较对称，不要一边高一边矮。
平衡二叉树的定义是，在任意子节点上，左右子树高度不超过1。
最先被发明的是[AVL](https://zh.wikipedia.org/wiki/AVL树)。 AVL树完全符合这个定义，红黑树和大多数平衡二叉树一样，没有完全符合这个定义，但不妨碍它是最常用的平衡二叉树。

红黑树满足以下要求：

1. 根节点是黑色的
2. 每个叶子节点都是不存储数据的黑色空节点
3. 红色节点被黑色节点隔开
4. 每个节点到叶子节点的所有路径，都包含相同的黑色节点数目

红黑树虽然没有完全遵循平衡二叉树的定义，但是因为其本身的设计，高度不会超过2logn，所以时间查找、插入、删除操作仍然是logn的。

> 引用：极客时间，数据结构与算法之美，红黑树